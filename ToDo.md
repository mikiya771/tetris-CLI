# ToDoList
## 目的と大まかな流れ 
CLIでテトリスを作る

開発の段階としては，
- 下調べ 懸念点の消化
    - GoでTestを書くことはできるか確認する
    - GoでCUIで画面表示を管理するツールの存在と使い方の確認

などなど


- ざっくりとした設計
    - ゲームってどんな部分から成立しているのかの確認
    - どこにどんな情報を持たせればいいのかの決定

などなど


- 個別の部分をTDDでこなしていく
    - Testが可能になる状態までToDoを書き下す
    - Testを書いてみて，実行する
    - 最短で成功するものをかく
    - ToDo, Test, Codeの全てをリファクタリングする

などなど

## 下調べをする
今回は，Golangの開発に不慣れなので，不安点の解消から入る
- [x] GoでTestを書くことはできるか
    - [x] 実際にTestを書くことはできるかどうか，一個書いてみて確認する 
- [x] GoでのCUIツール
    - [x] 画面への表示はできるか
    - [x] 画面上に再表示することはできるか(ゲーム画面としての働きをできるかどうか)
    - [x] 入力を受け付けてゲーム画面の更新を行うことができるか
## 大枠としての設計 
### テトリスとは
https://dic.nicovideo.jp/a/%E3%83%86%E3%83%88%E3%83%AA%E3%82%B9
```
「上から落ちてくる『４個の正方形で構成された７種類の多角形ブロック』（テトリミノ tetrimino）を操作して、
埋まった横列のみが消えるのを利用してテニス（tennis）のラリーのようにひたすら消し続けていく」
```
### テトリスにおける登場人物
登場人物を整理していく．この段階ではとにかく，細かい構成要素に分解していくことを考える.

登場人物としては
- プレイヤー
- 現在の状態をユーザーに表示するディスプレイ
- ユーザーが使用するキーボード
- アクティブな(=ユーザーが操作可能な)テトリミノ
- 非アクティブな(=すでにユーザー操作を離れた)テトリミノたち(以降では，"つまれたテトリミノの塊")
- テトリミノが存在可能な範囲としての枠
- 次に使用されるテトリミノ
- 次に使用されるテトリミノが表示される枠
- テトリミノのアクティブ，非アクティブを変換するためのロジック
- つまれたテトリミノの塊のうち，横列が埋まっていないかを確認するロジック
- ユーザーの入力を受けるもしくはルールを入れることで，テトリミノの位置情報を書き換えるロジック
 得点を計算するロジック

が考えられる．

ドメインルールとしては,
- テトリミノは枠の外に出ることはない
- テトリミノはその時点での底をなす部分(要議論)に接触して，n秒後に非アクティブになる
- テトリミノはアクティブであれば，m秒後に一個したに落ちようとする．
- ゲームエンドは枠の上限にテトリミノが達した時である

というものが考えられる

### ゲームシステムからみた登場人物の関連性
1. テトリミノおよびステージなどの情報
2. ユーザーにむけたDisplay
3. ユーザーによるinput もしくは 時間経過によるinput
4. テトリミノおよびステージのロジックに基づいた更新もしくは終了

というループでゲームが進行していく．


## ToDoList化していく
- [ ] テトリミノを定義して，コードにする
    - [ ] テトリミノは位置情報を持っている
    - [ ] テトリミノはその姿勢情報を持っている(回転の状態などを指す)
    - [ ] テトリミノはその形の情報を持っている
    - [ ] テトリミノは制限された場所の外に出ることはない
    - [ ] テトリミノはつまれたテトリミノの塊にかぶることはない
    - [ ] テトリミノは位置を移動するためのメソッドを持っている
    - [ ] テトリミノは姿勢を回転するためのメソッドを持っている
    - [ ] テトリミノは，ステージ底もしくは，つまれたテトリミノの塊につくことでつまれたテトリミノになるメソッドを持っている
- [ ] つまれたテトリミノの塊を定義して，コードにする 
    - [ ] つまれたテトリミノの塊は，非アクティブになるテトリミノを受け取って，一塊にすることができる．
    - [ ] つまれたテトリミノの塊は，ステージの横いっぱいになる行ができた時にそれを削除して，つめることができる
    - [ ] つまれたテトリミノの塊は，自身がゲーム実行可能であるかを判定できる

- [ ] 各種のイベントを受け取ってテトリミノの管理をする部分を定義する 
    - [ ] テトリミノを動かすことができる
        - [ ] ユーザー入力を受け取って．テトリミノにactionを送信する
        - [ ] システムからの入力を受け取って(n秒に一回とかで送るみたいな話)，テトリミノにactionを送信する
    - [ ] テトリミノを非アクティブにすることができる
        - [ ] テトリミノが非アクティブになった時,ゲームオーバー出なければ新しいテトリミノを作り，次のテトリミノを準備する
        - [ ] テトリミノが非アクティブになった時，ゲームーバーなら，ゲームオーバーする

- [ ] ゲームのディスプレイを定義して，コードする
    - [ ] ゲームのメインシステムは，アクティブなテトリミノとつまれたテトリミノの塊の情報からステージを表示できる
    - [ ] 次にアクティブになるテトリミノの情報から，次のテトリミノを表示できる
    - [ ] 現在の得点の情報を受け取って，それを表示できる
        
